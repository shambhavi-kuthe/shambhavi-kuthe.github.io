<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Shambhavi Kuthe">
<meta name="dcterms.date" content="2023-12-01">

<title>ML_Blog - Blog 3: Linear and Non-linear Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ML_Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Blog 3: Linear and Non-linear Regression</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Shambhavi Kuthe </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 1, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="understanding-linear-and-non-linear-regression-in-machine-learning" class="level1">
<h1>Understanding Linear and Non-linear Regression in Machine Learning</h1>
<p>Machine learning comprises a variety of algorithms and strategies for producing data-driven predictions or choices. The purpose of regression in this discipline is to model the connection between input data and a target variable. Linear and non-linear regression are the two basic forms, each suited to distinct sorts of data correlations.</p>
<section id="linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression">Linear Regression</h2>
<p>Linear regression is a simple and extensively used approach for modeling the connection between one or more independent variables (features) and a dependent variable (output). Fitting a linear equation to observed data is the essence of linear regression. This equation is as follows:</p>
<p><span class="math display">\[ Y=β0+β1X1+β2X2+…+βnXn+ϵ\]</span></p>
<p>Here:</p>
<ul>
<li><p>Y is the dependent variable</p></li>
<li><p>X1, X2,…,Xn are the independent variables,</p></li>
<li><p>β0, β1,…,βn are the coefficients representing the relationship between variables, and</p></li>
<li><p>ϵϵ is the error term.</p></li>
</ul>
<p>Linear regression assumes a linear relationship between the input and output characteristics. The coefficients are calculated using techniques such as the Least Squares approach, which minimizes the sum of the squared differences between the anticipated and actual values.</p>
</section>
<section id="non-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="non-linear-regression">Non-linear Regression</h2>
<p>In contrast, non-linear regression recognizes that the relationship between the independent and dependent variables is not strictly linear. Data may follow a more complicated pattern in many real-world circumstances. Modeling such relationships becomes more flexible using non-linear regression.</p>
<p>The sigmoid function is a popular example of a non-linear function: <span class="math display">\[Y=1/1+e^{−(β1(X−β2)Y}\]</span></p>
<p>In this case, β1 and β2 are parameters that must be approximated. The sigmoid function is often used when modeling binary outcomes, as it maps any real-valued number to the range (0, 1).</p>
</section>
<section id="the-code-breakdown-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="the-code-breakdown-linear-regression">The Code Breakdown: Linear Regression</h2>
<p>Let’s look at a real-world example of linear regression in Python. We utilize the FuelConsumption dataset in the given code to anticipate CO2 emissions depending on car engine size. The linear regression model is trained, displayed, and validated.</p>
<p><strong>Dataset:</strong></p>
<p>FuelConsumption.csv is a fuel consumption dataset that provides model-specific fuel consumption ratings and projected CO2 emissions for new light-duty cars for retail sale in Canada. The dataset is downloaded from: <a href="https://open.canada.ca/data/en/dataset/98f1a129-f628-4ce4-b24d-6f16bf24dd64" class="uri">https://open.canada.ca/data/en/dataset/98f1a129-f628-4ce4-b24d-6f16bf24dd64</a></p>
<p>The dataset has the following data:</p>
<ul>
<li><p>MODELYEAR e.g.&nbsp;2014</p></li>
<li><p>MAKE e.g.&nbsp;Acura MODEL e.g.&nbsp;ILX</p></li>
<li><p>VEHICLE CLASS e.g.&nbsp;SUV ENGINE</p></li>
<li><p>SIZE e.g.&nbsp;4.7</p></li>
<li><p>CYLINDERS e.g 6</p></li>
<li><p>TRANSMISSION e.g.&nbsp;A6</p></li>
<li><p>FUEL CONSUMPTION in CITY(L/100 km) e.g.&nbsp;9.9</p></li>
<li><p>FUEL CONSUMPTION in HWY (L/100 km) e.g.&nbsp;8.9</p></li>
<li><p>FUEL CONSUMPTION COMB (L/100 km) e.g.&nbsp;9.2</p></li>
<li><p>CO2 EMISSIONS (g/km) e.g.&nbsp;182 –&gt; low –&gt; 0</p></li>
</ul>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pylab <span class="im">as</span> pl</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the dataset</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'Data\FuelConsumption.csv'</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>df.head()</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting relevant column</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>cdf <span class="op">=</span> df[[<span class="st">'ENGINESIZE'</span>,<span class="st">'CYLINDERS'</span>,<span class="st">'FUELCONSUMPTION_COMB'</span>,<span class="st">'CO2EMISSIONS'</span>]]</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>cdf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ENGINESIZE</th>
<th data-quarto-table-cell-role="th">CYLINDERS</th>
<th data-quarto-table-cell-role="th">FUELCONSUMPTION_COMB</th>
<th data-quarto-table-cell-role="th">CO2EMISSIONS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2.0</td>
<td>4</td>
<td>8.5</td>
<td>196</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2.4</td>
<td>4</td>
<td>9.6</td>
<td>221</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1.5</td>
<td>4</td>
<td>5.9</td>
<td>136</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3.5</td>
<td>6</td>
<td>11.1</td>
<td>255</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3.5</td>
<td>6</td>
<td>10.6</td>
<td>244</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1062</td>
<td>3.0</td>
<td>6</td>
<td>11.8</td>
<td>271</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1063</td>
<td>3.2</td>
<td>6</td>
<td>11.5</td>
<td>264</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1064</td>
<td>3.0</td>
<td>6</td>
<td>11.8</td>
<td>271</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1065</td>
<td>3.2</td>
<td>6</td>
<td>11.3</td>
<td>260</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1066</td>
<td>3.2</td>
<td>6</td>
<td>12.8</td>
<td>294</td>
</tr>
</tbody>
</table>

<p>1067 rows × 4 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing the data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(cdf.ENGINESIZE,cdf.CO2EMISSIONS,color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Engine Size'</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Co2 Emissions'</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-3-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting data into training and testing sets</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>msk <span class="op">=</span> np.random.rand(<span class="bu">len</span>(df)) <span class="op">&lt;</span><span class="fl">0.8</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>training <span class="op">=</span> cdf[msk]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>testing <span class="op">=</span> cdf[<span class="op">~</span>msk]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Applying Polynomial Regression</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> PolynomialFeatures</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>trainingX <span class="op">=</span> np.asanyarray(training[[<span class="st">'ENGINESIZE'</span>]])</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>trainingY <span class="op">=</span> np.asanyarray(training[[<span class="st">'CO2EMISSIONS'</span>]])</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>testingX <span class="op">=</span> np.asanyarray(training[[<span class="st">'ENGINESIZE'</span>]])</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>testingY <span class="op">=</span> np.asanyarray(training[[<span class="st">'CO2EMISSIONS'</span>]])</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>poly <span class="op">=</span> PolynomialFeatures(degree<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>trainingX_poly <span class="op">=</span> poly.fit_transform(trainingX)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> LinearRegression()</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>trainingY <span class="op">=</span> clf.fit(trainingX_poly,trainingY)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Coefficient - </span><span class="sc">{}</span><span class="st"> </span><span class="ch">\n</span><span class="st"> Intercept - </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(clf.coef_,clf.intercept_))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficient - [[ 0.         28.64175088  4.53199322 -0.51235786]] 
 Intercept - [130.9310119]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing the data and the regression line</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(training[<span class="st">'ENGINESIZE'</span>],training[<span class="st">'CO2EMISSIONS'</span>],color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>xx <span class="op">=</span> np.arange(<span class="fl">0.0</span>,<span class="fl">10.0</span>,<span class="fl">0.1</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>yy <span class="op">=</span> clf.intercept_[<span class="dv">0</span>]<span class="op">+</span>clf.coef_[<span class="dv">0</span>][<span class="dv">1</span>]<span class="op">*</span>xx<span class="op">+</span>clf.coef_[<span class="dv">0</span>][<span class="dv">2</span>]<span class="op">*</span>np.power(xx,<span class="dv">2</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>plt.plot(xx,yy,<span class="st">'-r'</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Engine Size'</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Co2 Emission'</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-6-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluating model accuracy</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> r2_score</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>testingX_poly <span class="op">=</span> poly.fit_transform(testingX)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>testingY_ <span class="op">=</span> clf.predict(testingX_poly)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean absolute error: </span><span class="sc">%.2f</span><span class="st">"</span> <span class="op">%</span> np.mean(np.absolute(testingY_ <span class="op">-</span> testingY)))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Residual sum of squares (MSE): </span><span class="sc">%.2f</span><span class="st">"</span> <span class="op">%</span> np.mean((testingY_ <span class="op">-</span> testingY) <span class="op">**</span> <span class="dv">2</span>))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"R2-score: </span><span class="sc">%.2f</span><span class="st">"</span> <span class="op">%</span> r2_score(testingY_ , testingY) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean absolute error: 22.91
Residual sum of squares (MSE): 912.50
R2-score: 0.69</code></pre>
</div>
</div>
<p>The FuelConsumption dataset is used in this linear regression example to forecast CO2 emissions depending on engine size. The data is divided into training and testing sets, and a linear regression model is developed and assessed.</p>
</section>
<section id="the-code-breakdown-non-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="the-code-breakdown-non-linear-regression">The Code Breakdown: Non-linear Regression</h2>
<p>An example of non-linear regression is with GDP data from China over time. A sigmoid function is used to simulate GDP growth in this example. The curve_fit function is used to find the sigmoid function parameters, and the resultant model is plotted against the original data points.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the dataset   </span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"Data/china_gdp.csv"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1960</td>
<td>5.918412e+10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1961</td>
<td>4.955705e+10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1962</td>
<td>4.668518e+10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1963</td>
<td>5.009730e+10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1964</td>
<td>5.906225e+10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>1965</td>
<td>6.970915e+10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>1966</td>
<td>7.587943e+10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>1967</td>
<td>7.205703e+10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>1968</td>
<td>6.999350e+10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>1969</td>
<td>7.871882e+10</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalizing data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>x_data, y_data <span class="op">=</span> (df[<span class="st">"Year"</span>].values, df[<span class="st">"Value"</span>].values)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>x_data, y_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>(array([1960, 1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969, 1970,
        1971, 1972, 1973, 1974, 1975, 1976, 1977, 1978, 1979, 1980, 1981,
        1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992,
        1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003,
        2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014],
       dtype=int64),
 array([5.91841165e+10, 4.95570502e+10, 4.66851785e+10, 5.00973033e+10,
        5.90622549e+10, 6.97091531e+10, 7.58794348e+10, 7.20570286e+10,
        6.99934979e+10, 7.87188205e+10, 9.15062113e+10, 9.85620238e+10,
        1.12159814e+11, 1.36769878e+11, 1.42254742e+11, 1.61162492e+11,
        1.51627687e+11, 1.72349014e+11, 1.48382112e+11, 1.76856525e+11,
        1.89649992e+11, 1.94369049e+11, 2.03549627e+11, 2.28950201e+11,
        2.58082147e+11, 3.07479586e+11, 2.98805793e+11, 2.71349773e+11,
        3.10722214e+11, 3.45957486e+11, 3.58973230e+11, 3.81454704e+11,
        4.24934066e+11, 4.42874596e+11, 5.62261130e+11, 7.32032045e+11,
        8.60844098e+11, 9.58159425e+11, 1.02527690e+12, 1.08944711e+12,
        1.20526068e+12, 1.33223472e+12, 1.46190649e+12, 1.64992872e+12,
        1.94174560e+12, 2.26859890e+12, 2.72978403e+12, 3.52309431e+12,
        4.55843107e+12, 5.05941974e+12, 6.03965851e+12, 7.49243210e+12,
        8.46162316e+12, 9.49060260e+12, 1.03548317e+13]))</code></pre>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing the dataset</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(x_data,y_data,color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Year'</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'GDP Values'</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-10-output-1.png" width="589" height="443"></p>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>xdata <span class="op">=</span> x_data<span class="op">/</span><span class="bu">max</span>(x_data)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ydata <span class="op">=</span> y_data<span class="op">/</span><span class="bu">max</span>(y_data)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>xdata , ydata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>(array([0.97318769, 0.97368421, 0.97418073, 0.97467726, 0.97517378,
        0.97567031, 0.97616683, 0.97666336, 0.97715988, 0.97765641,
        0.97815293, 0.97864945, 0.97914598, 0.9796425 , 0.98013903,
        0.98063555, 0.98113208, 0.9816286 , 0.98212512, 0.98262165,
        0.98311817, 0.9836147 , 0.98411122, 0.98460775, 0.98510427,
        0.98560079, 0.98609732, 0.98659384, 0.98709037, 0.98758689,
        0.98808342, 0.98857994, 0.98907646, 0.98957299, 0.99006951,
        0.99056604, 0.99106256, 0.99155909, 0.99205561, 0.99255214,
        0.99304866, 0.99354518, 0.99404171, 0.99453823, 0.99503476,
        0.99553128, 0.99602781, 0.99652433, 0.99702085, 0.99751738,
        0.9980139 , 0.99851043, 0.99900695, 0.99950348, 1.        ]),
 array([0.0057156 , 0.00478589, 0.00450854, 0.00483806, 0.00570384,
        0.00673204, 0.00732793, 0.00695878, 0.0067595 , 0.00760213,
        0.00883705, 0.00951846, 0.01083164, 0.01320831, 0.01373801,
        0.01556399, 0.01464318, 0.01664431, 0.01432975, 0.01707961,
        0.01831512, 0.01877086, 0.01965745, 0.02211047, 0.02492384,
        0.02969431, 0.02885665, 0.02620514, 0.03000746, 0.03341025,
        0.03466722, 0.03683833, 0.04103727, 0.04276985, 0.0542994 ,
        0.07069473, 0.08313453, 0.09253259, 0.09901435, 0.10521147,
        0.11639597, 0.12865827, 0.1411811 , 0.15933902, 0.18752073,
        0.21908602, 0.26362418, 0.34023675, 0.44022261, 0.48860473,
        0.58326959, 0.7235687 , 0.81716665, 0.91653856, 1.        ]))</code></pre>
</div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining a sigmoid function</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sigmoid(x, Beta_1, Beta_2):</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>     y <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>Beta_1<span class="op">*</span>(x<span class="op">-</span>Beta_2)))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>     <span class="cf">return</span> y</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial prediction with sigmoid function</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>beta_1 <span class="op">=</span> <span class="fl">0.10</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>beta_2 <span class="op">=</span> <span class="fl">1990.0</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>Y_pred <span class="op">=</span> sigmoid(x_data, beta_1 , beta_2)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Determining values of beta_1 and beta_2 using curve_fit</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>plt.plot(x_data, Y_pred<span class="op">*</span><span class="fl">15000000000000.</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>plt.plot(x_data, y_data, <span class="st">'ro'</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-12-output-1.png" width="571" height="425"></p>
</div>
</div>
<p>Apparantly it doesnt fit the data</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lets normalize our data</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>xdata <span class="op">=</span> x_data<span class="op">/</span><span class="bu">max</span>(x_data)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>ydata <span class="op">=</span> y_data<span class="op">/</span><span class="bu">max</span>(y_data)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>xdata , ydata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>(array([0.97318769, 0.97368421, 0.97418073, 0.97467726, 0.97517378,
        0.97567031, 0.97616683, 0.97666336, 0.97715988, 0.97765641,
        0.97815293, 0.97864945, 0.97914598, 0.9796425 , 0.98013903,
        0.98063555, 0.98113208, 0.9816286 , 0.98212512, 0.98262165,
        0.98311817, 0.9836147 , 0.98411122, 0.98460775, 0.98510427,
        0.98560079, 0.98609732, 0.98659384, 0.98709037, 0.98758689,
        0.98808342, 0.98857994, 0.98907646, 0.98957299, 0.99006951,
        0.99056604, 0.99106256, 0.99155909, 0.99205561, 0.99255214,
        0.99304866, 0.99354518, 0.99404171, 0.99453823, 0.99503476,
        0.99553128, 0.99602781, 0.99652433, 0.99702085, 0.99751738,
        0.9980139 , 0.99851043, 0.99900695, 0.99950348, 1.        ]),
 array([0.0057156 , 0.00478589, 0.00450854, 0.00483806, 0.00570384,
        0.00673204, 0.00732793, 0.00695878, 0.0067595 , 0.00760213,
        0.00883705, 0.00951846, 0.01083164, 0.01320831, 0.01373801,
        0.01556399, 0.01464318, 0.01664431, 0.01432975, 0.01707961,
        0.01831512, 0.01877086, 0.01965745, 0.02211047, 0.02492384,
        0.02969431, 0.02885665, 0.02620514, 0.03000746, 0.03341025,
        0.03466722, 0.03683833, 0.04103727, 0.04276985, 0.0542994 ,
        0.07069473, 0.08313453, 0.09253259, 0.09901435, 0.10521147,
        0.11639597, 0.12865827, 0.1411811 , 0.15933902, 0.18752073,
        0.21908602, 0.26362418, 0.34023675, 0.44022261, 0.48860473,
        0.58326959, 0.7235687 , 0.81716665, 0.91653856, 1.        ]))</code></pre>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We need to determine the values of beta_1 and beta_2</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> curve_fit</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>popt, pcov <span class="op">=</span> curve_fit(sigmoid, xdata, ydata)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print the final parameters</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" beta_1 = </span><span class="sc">%f</span><span class="st">, beta_2 = </span><span class="sc">%f</span><span class="st">"</span> <span class="op">%</span> (popt[<span class="dv">0</span>], popt[<span class="dv">1</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> beta_1 = 690.451712, beta_2 = 0.997207</code></pre>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the regression model</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">1960</span>,<span class="dv">2015</span>,<span class="dv">55</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x<span class="op">/</span><span class="bu">max</span>(x)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> sigmoid(x,<span class="op">*</span>popt)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>plt.plot(xdata, ydata, <span class="st">'ro'</span>, label<span class="op">=</span><span class="st">'data'</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>plt.plot(x,y,linewidth<span class="op">=</span><span class="fl">3.0</span>,label<span class="op">=</span><span class="st">'fit'</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'best'</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Year'</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Values'</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-15-output-1.png" width="589" height="429"></p>
</div>
</div>
<p>We utilize a sigmoid function to simulate China’s GDP growth over time in this non-linear regression example. The data is normalized, and the curve_fit function is used to find the best sigmoid function parameters. The generated model is then compared to the original data points.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Finally, both linear and non-linear regression play important roles in machine learning, catering to different types of data correlations. Linear regression is appropriate for linear connections, but non-linear regression is more versatile for capturing complicated patterns. The decision relies on the type of the data as well as the underlying connections to be modeled. Python and its libraries, like as NumPy and scikit-learn, provide strong tools for creating and visualizing regression models, as we’ve shown.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>